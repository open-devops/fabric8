## 弹性和韧性

你的微服务应该**高可用**，并且在失效时具备**韧性**。理想情况下，每个微服务都应该具备**弹性**，以便容易地对每个微服务的使用容器数量进行扩张或缩小。一些微服务也许只需要一个容器，而其他的微服务则需要很多。

很多时候在考虑弹性时，你不得不考虑你的应用是无状态还是有状态的。无状态应用比较容易缩放，但是有状态应用需要更多的照顾。比如，一个有状态的数据存储将会需要分片和向集群成员复制它的状态，并且知道在缩放事件过程中如何重新负载平衡。 

Fabric8 通过使用 Kubernetes [Replica Sets（副本集）](../replicationControllers.html)（曾经被称为副本控制器） 解决了这些弹性和韧性问题。就像大多数 Kubernetes 的配置一样，一个副本集是调停期待状态的一种方式：你告诉 Kubernetes 系统应该是什么状态，Kubernetes 就会断定如何达到这种状态。一个副本集控制着在任何时刻应该在运行的副本数量或应用拷贝。   

一个副本集定义了为了运行一个或多个 [Pods](../pods.html) 的模板，然后就可以基于一些系统高水位信息，由运维人员或者 Kubernetes 自动完成系统扩张或缩小。

副本集使用一个 **selector（选择器）** 来不断监视满足选择器标签的可用 Pods。如果缺少足够的运行状态的 Pods，它会启动更多的 Pods；如果有太多的运行状态的 Pods，它会终止多余的 Pods。

### 基于运维人员的缩放

为了缩放你的副本集，你只需要在你的副本集 YAML 文件中，指定你希望的默认副本数量。默认数量为 1 确保了始终有一个运行中的 Pod。如果一个 Pod 终止了（或者运行着 Pod 的主机终止了），Kubernetes就会自动地为你启动另外一个 Pod。

### 自动缩放

为了自动缩放，你需要使用所需的元数据注释你的副本集，比如 CPU 限制，或自定义指标，以使 Kubernetes 知道什么时候扩张或者缩小 Pods 的数量。然后你就可以创建一个 [HorizontalPodAutoscaler（水平自动缩放器）](http://kubernetes.io/docs/user-guide/horizontal-pod-autoscaling/) 来使 Kubernetes 知道哪些 Pods/ReplicaSets 应该参与到自动缩放当中。